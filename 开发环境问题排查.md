# 开发环境问题排查指南

## 当前状态
- 开发服务器已在 http://localhost:3001 运行
- 项目编译成功，无 TypeScript 错误
- 已添加错误边界组件用于错误捕获

## 如果页面仍然崩溃，请按以下步骤排查：

### 1. 立即查看错误详情
访问诊断页面：
```
http://localhost:3001/debug
```

### 2. 检查浏览器控制台
1. 在浏览器中打开开发者工具 (F12)
2. 查看 Console 选项卡是否有红色错误信息
3. 记录任何错误消息

### 3. 检查网络请求
1. 在开发者工具中打开 Network 选项卡
2. 刷新页面
3. 查看是否有失败的请求（红色状态）

### 4. 检查环境变量
确认 `.env.local` 文件包含有效的 Supabase 配置：
```bash
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
NEXT_PUBLIC_SITE_URL=http://localhost:3000
```

### 5. 重启开发服务器
```bash
# 停止当前服务器 (Ctrl+C)
npm run dev
```

### 6. 清除缓存
```bash
# 删除缓存和重新安装依赖
rm -rf .next node_modules package-lock.json
npm install
npm run dev
```

### 7. 访问特定页面测试
- 主页: http://localhost:3001/
- 诊断页面: http://localhost:3001/debug
- 产品页面: http://localhost:3001/products

## 常见问题解决方案

### 问题 1: Supabase 连接错误
- 检查 Supabase 项目是否激活
- 确认 URL 和密钥是否正确
- 检查网络连接

### 问题 2: 环境变量未加载
- 确保 `.env.local` 文件在项目根目录
- 重启开发服务器
- 检查文件名拼写（不是 `.env.local.txt`）

### 问题 3: 端口冲突
- 关闭其他使用 3000/3001 端口的程序
- 或在 package.json 中指定其他端口

### 问题 4: 模块导入错误
- 运行 `npm run build` 检查构建错误
- 检查 TypeScript 配置

## 如果问题持续存在
1. 提供浏览器控制台的完整错误信息
2. 截图错误页面
3. 说明具体的操作步骤和出错时机 