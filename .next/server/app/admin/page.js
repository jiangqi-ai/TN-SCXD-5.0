(()=>{var e={};e.id=3,e.ids=[3],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},1547:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>o,routeModule:()=>u,tree:()=>d});var r=s(7096),a=s(6132),i=s(7284),n=s.n(i),l=s(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,3729)),"E:\\starter-template\\TN-SCXD-5.0\\app\\admin\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5689)),"E:\\starter-template\\TN-SCXD-5.0\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],o=["E:\\starter-template\\TN-SCXD-5.0\\app\\admin\\page.tsx"],m="/admin/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},9582:(e,t,s)=>{Promise.resolve().then(s.bind(s,6578))},6578:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(3854),a=s(4218),i=s(3984),n=s(3225),l=s(8466),c=s(6934),d=s(7112),o=s(7787);function m(){let[e,t]=(0,a.useState)(null),[s,m]=(0,a.useState)(!0),x=(0,i.JU)();(0,a.useEffect)(()=>{u()},[]);let u=async()=>{try{let{count:e}=await x.from("profiles").select("*",{count:"exact",head:!0}),{count:s}=await x.from("products").select("*",{count:"exact",head:!0}).eq("is_active",!0),{count:r}=await x.from("orders").select("*",{count:"exact",head:!0}),{data:a}=await x.from("orders").select("total_amount").eq("status","delivered"),i=a?.reduce((e,t)=>e+t.total_amount,0)||0,{data:n}=await x.from("orders").select(`
          id,
          total_amount,
          status,
          created_at,
          user_id,
          profiles!orders_user_id_fkey (
            full_name,
            email
          )
        `).order("created_at",{ascending:!1}).limit(5),{data:l}=await x.from("products").select("id, name, stock_quantity").eq("is_active",!0).lte("stock_quantity",10).order("stock_quantity",{ascending:!0}).limit(5);t({totalUsers:e||0,totalProducts:s||0,totalOrders:r||0,totalRevenue:i,recentOrders:(n||[]).map(e=>({...e,profiles:Array.isArray(e.profiles)?e.profiles[0]:e.profiles})),lowStockProducts:l||[]})}catch(e){console.error("Error fetching dashboard data:",e)}finally{m(!1)}},h=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(e),p=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),y=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=e=>{switch(e){case"pending":return"待处理";case"processing":return"处理中";case"shipped":return"已发货";case"delivered":return"已送达";case"cancelled":return"已取消";default:return e}};if(s)return r.jsx(n.Z,{children:r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})})});let f=[{name:"总用户数",stat:e?.totalUsers||0,icon:l.Z,color:"bg-blue-500"},{name:"总产品数",stat:e?.totalProducts||0,icon:c.Z,color:"bg-green-500"},{name:"总订单数",stat:e?.totalOrders||0,icon:d.Z,color:"bg-purple-500"},{name:"总收入",stat:h(e?.totalRevenue||0),icon:o.Z,color:"bg-yellow-500"}];return r.jsx(n.Z,{children:(0,r.jsxs)("div",{className:"px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"sm:flex sm:items-center",children:(0,r.jsxs)("div",{className:"sm:flex-auto",children:[r.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"仪表板"}),r.jsx("p",{className:"mt-2 text-sm text-gray-700",children:"系统概览和关键数据统计"})]})}),r.jsx("div",{className:"mt-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4",children:f.map(e=>r.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:r.jsx("div",{className:"p-5",children:(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:`w-10 h-10 ${e.color} rounded-md flex items-center justify-center`,children:r.jsx(e.icon,{className:"w-6 h-6 text-white"})})}),r.jsx("div",{className:"ml-5 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:e.name}),r.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.stat})]})})]})})},e.name))}),(0,r.jsxs)("div",{className:"mt-8 grid grid-cols-1 gap-8 lg:grid-cols-2",children:[r.jsx("div",{className:"bg-white shadow rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[r.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"最近订单"}),r.jsx("div",{className:"flow-root",children:e?.recentOrders.length===0?r.jsx("p",{className:"text-gray-500 text-center py-4",children:"暂无订单"}):r.jsx("ul",{className:"-my-5 divide-y divide-gray-200",children:e?.recentOrders.map(e=>r.jsx("li",{className:"py-4",children:r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.profiles?.full_name||e.profiles?.email||"未知用户"}),r.jsx("p",{className:"text-sm text-gray-500",children:p(e.created_at)})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:h(e.total_amount)}),r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(e.status)}`,children:g(e.status)})]})]})},e.id))})})]})}),r.jsx("div",{className:"bg-white shadow rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[r.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:"库存预警"}),r.jsx("div",{className:"flow-root",children:e?.lowStockProducts.length===0?r.jsx("p",{className:"text-gray-500 text-center py-4",children:"库存充足"}):r.jsx("ul",{className:"-my-5 divide-y divide-gray-200",children:e?.lowStockProducts.map(e=>r.jsx("li",{className:"py-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex-1 min-w-0",children:r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name})}),r.jsx("div",{className:"flex items-center",children:r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${0===e.stock_quantity?"bg-red-100 text-red-800":e.stock_quantity<=5?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:["库存: ",e.stock_quantity]})})]})},e.id))})})]})})]})]})})}},3225:(e,t,s)=>{"use strict";s.d(t,{Z:()=>N});var r=s(3854),a=s(7896),i=s(1018),n=s(4218),l=s(5548),c=s.n(l),d=s(5572),o=s(6934),m=s(7112),x=s(8466),u=s(518),h=s(1170),p=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let y=(0,p.Z)("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);var g=s(4212),f=s(7004),v=s(4920),j=s(1559);function N({children:e}){let{user:t,profile:s,loading:l}=(0,a.useAuth)(),p=(0,i.useRouter)(),N=(0,i.usePathname)(),[b,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{l||t&&s?.role==="admin"||p.push("/")},[t,s,l,p]);let w=[{name:"仪表板",href:"/admin",icon:d.Z,current:"/admin"===N},{name:"产品管理",href:"/admin/products",icon:o.Z,current:"/admin/products"===N},{name:"订单管理",href:"/admin/orders",icon:m.Z,current:"/admin/orders"===N},{name:"用户管理",href:"/admin/users",icon:x.Z,current:"/admin/users"===N},{name:"用户设置",href:"/admin/user-settings",icon:u.Z,current:"/admin/user-settings"===N},{name:"数据库管理",href:"/admin/database",icon:h.Z,current:"/admin/database"===N},{name:"数据库配置",href:"/admin/database-config",icon:y,current:"/admin/database-config"===N},{name:"系统设置",href:"/admin/settings",icon:u.Z,current:"/admin/settings"===N},{name:"系统初始化",href:"/admin/setup",icon:g.Z,current:"/admin/setup"===N},{name:"数据统计",href:"/admin/analytics",icon:f.Z,current:"/admin/analytics"===N}];return l?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):t&&s?.role==="admin"?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsxs)("div",{className:`fixed inset-0 z-40 lg:hidden ${b?"block":"hidden"}`,children:[r.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>k(!1)}),(0,r.jsxs)("div",{className:"relative flex-1 flex flex-col max-w-xs w-full bg-white",children:[r.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:r.jsx("button",{type:"button",className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>k(!1),children:r.jsx(v.Z,{className:"h-6 w-6 text-white"})})}),(0,r.jsxs)("div",{className:"flex-1 h-0 pt-5 pb-4 overflow-y-auto",children:[r.jsx("div",{className:"flex-shrink-0 flex items-center px-4",children:r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"管理后台"})}),r.jsx("nav",{className:"mt-5 px-2 space-y-1",children:w.map(e=>(0,r.jsxs)(c(),{href:e.href,className:`group flex items-center px-2 py-2 text-base font-medium rounded-md ${e.current?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,onClick:()=>k(!1),children:[r.jsx(e.icon,{className:`mr-4 flex-shrink-0 h-6 w-6 ${e.current?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),e.name]},e.name))})]})]})]}),r.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:r.jsx("div",{className:"flex-1 flex flex-col min-h-0 bg-white border-r border-gray-200",children:(0,r.jsxs)("div",{className:"flex-1 flex flex-col pt-5 pb-4 overflow-y-auto",children:[r.jsx("div",{className:"flex items-center flex-shrink-0 px-4",children:r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"管理后台"})}),r.jsx("nav",{className:"mt-5 flex-1 px-2 space-y-1",children:w.map(e=>(0,r.jsxs)(c(),{href:e.href,className:`group flex items-center px-2 py-2 text-sm font-medium rounded-md ${e.current?"bg-primary-100 text-primary-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[r.jsx(e.icon,{className:`mr-3 flex-shrink-0 h-6 w-6 ${e.current?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`}),e.name]},e.name))})]})})}),(0,r.jsxs)("div",{className:"lg:pl-64 flex flex-col flex-1",children:[r.jsx("div",{className:"sticky top-0 z-10 lg:hidden pl-1 pt-1 sm:pl-3 sm:pt-3 bg-gray-100",children:r.jsx("button",{type:"button",className:"-ml-0.5 -mt-0.5 h-12 w-12 inline-flex items-center justify-center rounded-md text-gray-500 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500",onClick:()=>k(!0),children:r.jsx(j.Z,{className:"h-6 w-6"})})}),r.jsx("main",{className:"flex-1",children:r.jsx("div",{className:"py-6",children:e})})]})]}):null}},7004:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},1170:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},7787:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},5572:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},1559:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},4212:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},8466:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},4920:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(3708);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},1018:(e,t,s)=>{"use strict";e.exports=s(7804)},3729:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>c});var r=s(5153);let a=(0,r.createProxy)(String.raw`E:\starter-template\TN-SCXD-5.0\app\admin\page.tsx`),{__esModule:i,$$typeof:n}=a,l=a.default,c=l}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[271,502,916],()=>s(1547));module.exports=r})();