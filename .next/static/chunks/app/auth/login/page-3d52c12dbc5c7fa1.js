(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[716],{7216:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,i.Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])},211:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,i.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},5589:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,i.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},1295:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,i.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},1601:function(e,t,n){Promise.resolve().then(n.bind(n,6663))},6663:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var i=n(7437),a=n(2265),s=n(1396),r=n.n(s),o=n(4033),l=n(2899),c=n(1865),u=n(5925),d=n(1295),f=n(5589),m=n(7216),h=n(211);function y(){let[e,t]=(0,a.useState)(!1),[n,s]=(0,a.useState)(!1),y=(0,o.useRouter)(),p=(0,l.JU)(),{register:g,handleSubmit:b,formState:{errors:x}}=(0,c.cI)(),v=async e=>{s(!0);try{let{data:t,error:n}=await p.auth.signInWithPassword({email:e.email,password:e.password});if(n){u.default.error(n.message);return}u.default.success("登录成功！"),y.push("/")}catch(e){u.default.error("登录失败，请重试")}finally{s(!1)}};return(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"登录您的账户"}),(0,i.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["还没有账户？"," ",(0,i.jsx)(r(),{href:"/auth/register",className:"font-medium text-primary-600 hover:text-primary-500",children:"立即注册"})]})]}),(0,i.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:b(v),children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"邮箱地址"}),(0,i.jsxs)("div",{className:"mt-1 relative",children:[(0,i.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,i.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"})}),(0,i.jsx)("input",{...g("email",{required:"请输入邮箱地址",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"请输入有效的邮箱地址"}}),type:"email",className:"input-field pl-10",placeholder:"请输入邮箱地址"})]}),x.email&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.email.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码"}),(0,i.jsxs)("div",{className:"mt-1 relative",children:[(0,i.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,i.jsx)(f.Z,{className:"h-5 w-5 text-gray-400"})}),(0,i.jsx)("input",{...g("password",{required:"请输入密码",minLength:{value:6,message:"密码至少6位"}}),type:e?"text":"password",className:"input-field pl-10 pr-10",placeholder:"请输入密码"}),(0,i.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>t(!e),children:e?(0,i.jsx)(m.Z,{className:"h-5 w-5 text-gray-400"}):(0,i.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"})})]}),x.password&&(0,i.jsx)("p",{className:"mt-1 text-sm text-red-600",children:x.password.message})]})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{type:"submit",disabled:n,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:n?"登录中...":"登录"})})]})]})})}},7521:function(e,t,n){"use strict";var i=n(2362),a=n(2601);class s{static getDefaultConfig(){let e="https://demo-project.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.demo";return e&&t?{url:e,anonKey:t,serviceRoleKey:a.env.SUPABASE_SERVICE_ROLE_KEY,connectionPool:10,timeout:30}:null}static async loadConfigFromDatabase(){try{let e=this.getDefaultConfig();if(!e)return console.warn("No default config available, cannot load from database"),null;let t=(0,i.eI)(e.url,e.anonKey),{data:n,error:a}=await t.from("settings").select("key, value").in("key",["db_url","db_anon_key","db_service_key","db_connection_pool","db_timeout"]);if(a)return console.warn("Failed to load config from database:",a),e;if(!n||0===n.length)return console.log("No database config found, using default"),e;let s={};n.forEach(e=>{switch(e.key){case"db_url":s.url=e.value;break;case"db_anon_key":s.anonKey=e.value;break;case"db_service_key":s.serviceRoleKey=e.value;break;case"db_connection_pool":s.connectionPool=parseInt(e.value)||10;break;case"db_timeout":s.timeout=parseInt(e.value)||30}});let r={url:s.url||e.url,anonKey:s.anonKey||e.anonKey,serviceRoleKey:s.serviceRoleKey||e.serviceRoleKey,connectionPool:s.connectionPool||10,timeout:s.timeout||30};return console.log("Loaded config from database successfully"),r}catch(e){return console.error("Error loading config from database:",e),this.getDefaultConfig()}}static async initialize(){if(this.instance.initialized&&this.instance.client)return this.instance.client;try{let e=await this.loadConfigFromDatabase();if(e||(e=this.getDefaultConfig()),!e)return console.error("No valid Supabase configuration found"),null;let t=(0,i.eI)(e.url,e.anonKey,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}});return this.instance.config=e,this.instance.client=t,this.instance.initialized=!0,console.log("Supabase client initialized successfully"),t}catch(e){return console.error("Failed to initialize Supabase client:",e),null}}static getClient(){return this.instance.client}static getConfig(){return this.instance.config}static async reloadConfig(){return this.instance.initialized=!1,this.instance.client=null,this.instance.config=null,await this.initialize()}static async updateConfig(e){try{let t=this.getClient();if(!t)throw Error("No client available for config update");let n=[];for(let i of(e.url&&n.push({key:"db_url",value:e.url,category:"database",is_public:!1}),e.anonKey&&n.push({key:"db_anon_key",value:e.anonKey,category:"database",is_public:!1}),e.serviceRoleKey&&n.push({key:"db_service_key",value:e.serviceRoleKey,category:"database",is_public:!1}),void 0!==e.connectionPool&&n.push({key:"db_connection_pool",value:e.connectionPool.toString(),category:"database",is_public:!1}),void 0!==e.timeout&&n.push({key:"db_timeout",value:e.timeout.toString(),category:"database",is_public:!1}),n)){let{error:e}=await t.from("settings").upsert(i,{onConflict:"key"});if(e)throw e}return await this.reloadConfig(),console.log("Database config updated successfully"),!0}catch(e){return console.error("Failed to update database config:",e),!1}}static async checkConnection(){try{let e=this.getClient();if(!e)return{connected:!1,error:"No client available"};let{data:t,error:n}=await e.from("settings").select("count").limit(1);if(n)return{connected:!1,error:n.message};return{connected:!0}}catch(e){return{connected:!1,error:e.message}}}}s.instance={config:null,client:null,initialized:!1},t.Z=s},2899:function(e,t,n){"use strict";n.d(t,{JU:function(){return s}});var i=n(2362),a=n(7521);function s(){let e=a.Z.getClient();if(e)return e;let t="https://demo-project.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.demo";if(!t)throw console.error("Missing NEXT_PUBLIC_SUPABASE_URL environment variable"),Error("Supabase URL is required");if(!n)throw console.error("Missing NEXT_PUBLIC_SUPABASE_ANON_KEY environment variable"),Error("Supabase Anonymous Key is required");let s=(0,i.eI)(t,n,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}});return s}s()},1396:function(e,t,n){e.exports=n(8326)}},function(e){e.O(0,[199,326,535,971,472,744],function(){return e(e.s=1601)}),_N_E=e.O()}]);