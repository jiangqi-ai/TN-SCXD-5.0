# Supabase äº‘ç«¯æ•°æ®åº“é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

è¿™ä¸ªé¡¹ç›®ç°åœ¨æ”¯æŒäº‘ç«¯æ•°æ®åŒæ­¥ï¼Œä½¿ç”¨ Supabase ä½œä¸ºåç«¯æ•°æ®åº“ã€‚è¿™æ„å‘³ç€ï¼š

- âœ… **æ•°æ®æŒä¹…åŒ–**: æœåŠ¡å™¨é‡å¯ä¸ä¼šä¸¢å¤±æ•°æ®
- âœ… **å¤šè®¾å¤‡åŒæ­¥**: åœ¨ä»»ä½•è®¾å¤‡ä¸Šè®¿é—®éƒ½æ˜¯åŒä¸€ä»½æ•°æ®
- âœ… **å®æ—¶æ›´æ–°**: æ”¯æŒå®æ—¶æ•°æ®åŒæ­¥
- âœ… **ç”Ÿäº§å°±ç»ª**: å¯éƒ¨ç½²åˆ°ä»»ä½•äº‘å¹³å°

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: åˆ›å»º Supabase é¡¹ç›®

1. è®¿é—® [Supabaseå®˜ç½‘](https://supabase.com)
2. ç‚¹å‡» "Start your project" æˆ– "Sign Up"
3. æ³¨å†Œè´¦æˆ·ï¼ˆæ”¯æŒGitHubç™»å½•ï¼‰
4. åˆ›å»ºæ–°é¡¹ç›®ï¼š
   - Project Name: `climbing-gear-store`
   - Database Password: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç 
   - Region: é€‰æ‹©ç¦»æ‚¨æœ€è¿‘çš„åŒºåŸŸ

### æ­¥éª¤ 2: è·å–é¡¹ç›®é…ç½®

é¡¹ç›®åˆ›å»ºå®Œæˆåï¼Œè¿›å…¥é¡¹ç›®ä»ªè¡¨æ¿ï¼š

1. åœ¨å·¦ä¾§èœå•ä¸­ç‚¹å‡» "Settings" â†’ "API"
2. å¤åˆ¶ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **Project URL** (ç±»ä¼¼: `https://xxx.supabase.co`)
   - **anon/public key**
   - **service_role key** (ç‚¹å‡»çœ¼ç›å›¾æ ‡æ˜¾ç¤º)

### æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡

1. åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env.local` æ–‡ä»¶
2. å¤åˆ¶ `env-example.txt` çš„å†…å®¹åˆ° `.env.local`
3. æ›¿æ¢é…ç½®å€¼ï¼š

```env
NEXT_PUBLIC_SUPABASE_URL=https://ä½ çš„é¡¹ç›®ID.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=ä½ çš„anonå¯†é’¥
SUPABASE_SERVICE_ROLE_KEY=ä½ çš„service_roleå¯†é’¥
```

### æ­¥éª¤ 4: åˆ›å»ºæ•°æ®åº“è¡¨

1. åœ¨ Supabase ä»ªè¡¨æ¿ä¸­ï¼Œç‚¹å‡»å·¦ä¾§ "SQL Editor"
2. ç‚¹å‡» "New query"
3. å¤åˆ¶ `supabase-schema.sql` æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹
4. ç²˜è´´åˆ° SQL ç¼–è¾‘å™¨ä¸­
5. ç‚¹å‡» "Run" æ‰§è¡Œ

### æ­¥éª¤ 5: å¯åŠ¨åº”ç”¨

```bash
npm run dev
```

ç°åœ¨æ‚¨çš„åº”ç”¨å·²ç»è¿æ¥åˆ°äº‘ç«¯æ•°æ®åº“ï¼

## ğŸ”§ åŠŸèƒ½ç‰¹æ€§

### æ•°æ®åŒæ­¥
- äº§å“ä¿¡æ¯å®æ—¶åŒæ­¥
- è´­ç‰©è½¦çŠ¶æ€å¤šè®¾å¤‡å…±äº«
- è®¢å•çŠ¶æ€å®æ—¶æ›´æ–°

### å®‰å…¨æ€§
- Row Level Security (RLS) å·²å¯ç”¨
- ç”¨æˆ·æ•°æ®éš”ç¦»
- APIå¯†é’¥æƒé™æ§åˆ¶

### æ‰©å±•æ€§
- æ”¯æŒæ— é™ç”¨æˆ·
- è‡ªåŠ¨æ•°æ®å¤‡ä»½
- 99.9% å¯ç”¨æ€§ä¿è¯

## ğŸ“Š æ•°æ®åº“ç»“æ„

| è¡¨å | è¯´æ˜ |
|------|------|
| `products` | äº§å“ä¿¡æ¯ |
| `users` | ç”¨æˆ·ä¿¡æ¯ |
| `cart_items` | è´­ç‰©è½¦é¡¹ç›® |
| `orders` | è®¢å• |
| `order_items` | è®¢å•æ˜ç»† |

## ğŸ” éªŒè¯è®¾ç½®

è®¾ç½®å®Œæˆåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

1. **æ•°æ®åº“è¿æ¥**: è®¿é—®äº§å“é¡µé¢ï¼ŒæŸ¥çœ‹æ˜¯å¦æ˜¾ç¤ºäº§å“
2. **æ•°æ®å†™å…¥**: åœ¨ç®¡ç†åå°æ·»åŠ æ–°äº§å“
3. **å®æ—¶åŒæ­¥**: åœ¨å¤šä¸ªæµè§ˆå™¨çª—å£ä¸­æµ‹è¯•æ•°æ®åŒæ­¥

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**é—®é¢˜**: é¡µé¢æ˜¾ç¤º "è·å–æ•°æ®å¤±è´¥"
**è§£å†³**: 
1. æ£€æŸ¥ `.env.local` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”é…ç½®æ­£ç¡®
2. ç¡®è®¤ Supabase é¡¹ç›® URL å’Œå¯†é’¥æ— è¯¯
3. æ£€æŸ¥æ•°æ®åº“è¡¨æ˜¯å¦å·²åˆ›å»º

**é—®é¢˜**: API è¯·æ±‚è¿”å› 401 é”™è¯¯
**è§£å†³**: 
1. æ£€æŸ¥ `service_role` å¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ RLS ç­–ç•¥æ˜¯å¦æ­£ç¡®è®¾ç½®

**é—®é¢˜**: æŸäº›åŠŸèƒ½æ— æ³•ä½¿ç”¨
**è§£å†³**: 
1. ç¡®è®¤å·²æ‰§è¡Œå®Œæ•´çš„ `supabase-schema.sql`
2. æ£€æŸ¥è¡¨ç»“æ„æ˜¯å¦å®Œæ•´

## ğŸ”„ ä»å†…å­˜å­˜å‚¨è¿ç§»

å¦‚æœæ‚¨ä¹‹å‰ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œç°åœ¨åˆ‡æ¢åˆ° Supabaseï¼š

1. æ‰€æœ‰ API è·¯ç”±å·²è‡ªåŠ¨æ›´æ–°
2. æ•°æ®æ ¼å¼ä¿æŒå…¼å®¹
3. ç°æœ‰åŠŸèƒ½æ— éœ€ä¿®æ”¹

## ğŸ“ˆ ç”Ÿäº§éƒ¨ç½²

éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ—¶ï¼š

1. ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒçš„ Supabase é¡¹ç›®
2. æ›´æ–°ç¯å¢ƒå˜é‡
3. ç¡®ä¿å¯ç”¨äº†é€‚å½“çš„å®‰å…¨ç­–ç•¥

## ğŸ’¡ è¿›é˜¶åŠŸèƒ½

### å®æ—¶è®¢é˜…
å¯ä»¥æ·»åŠ å®æ—¶æ•°æ®ç›‘å¬ï¼š

```typescript
supabase
  .channel('products')
  .on('postgres_changes', 
    { event: '*', schema: 'public', table: 'products' },
    (payload) => {
      console.log('äº§å“æ•°æ®æ›´æ–°:', payload)
    }
  )
  .subscribe()
```

### æ–‡ä»¶å­˜å‚¨
Supabase è¿˜æä¾›æ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼Œå¯ç”¨äºäº§å“å›¾ç‰‡ï¼š

```typescript
const { data, error } = await supabase.storage
  .from('product-images')
  .upload('image.jpg', file)
```

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [Supabase æ–‡æ¡£](https://supabase.com/docs)
2. æ£€æŸ¥é¡¹ç›®çš„ GitHub Issues
3. å‚è€ƒ Supabase ç¤¾åŒºè®ºå›

---

ğŸ‰ **æ­å–œï¼æ‚¨ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå…·æœ‰äº‘ç«¯åŒæ­¥åŠŸèƒ½çš„å®Œæ•´ç”µå•†ç³»ç»Ÿï¼** 